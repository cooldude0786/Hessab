<!DOCTYPE html>
<html lang="en">

<head>
  <title>Records</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>

  <!-- <div class="container"> -->
  <!-- <h2>Modal Example</h2> -->
  <!-- Button to Open the Modal -->
  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
    Karcha Daal
  </button>

  <!-- The Modal -->
  <div class="modal" id="myModal" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="col-md-12 d-flex flex-column modal-header">
          <div class="d-flex w-100">
            <h4 class="modal-title">Enter Records</h4>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="d-flex justify-content-end w-100">Date:-</div>
        </div>
        <div class="modal-body">
          <div class="d-flex col-md-12 align-items-center p-0">
            <div class="col-md-4 text-center">Saaman ka naam daal </div>
            <div class="col-md-8 p-0">
              <input class="form-control p-1" id="SaamanName" name="SaamanName" value=null type="text">
            </div>
          </div>
          <div class="d-flex col-md-12 align-items-center p-0">
            <div class="col-md-4">Rupea daal </div>
            <div class="col-md-8 p-0 input-group">
              <div class="input-group-prepend">
                <span class="input-group-text" id="basic-addon1">$</span>
              </div>
              <input class="form-control p-1" id="Paisa" name="Paisa" value=0 type="number">
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          <button type="button" id="EnterDetails" class="btn btn-primary">Enter</button>
        </div>

      </div>
    </div>
  </div>

  <!-- modal 2 -->
  <div class="modal" id="entername" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="col-md-12 d-flex flex-column modal-header">
          <div class="d-flex w-100">
            <h4 class="modal-title">Enter Name</h4>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="d-flex justify-content-end w-100">Date:-</div>
        </div>
        <div class="modal-body">
          <div class="d-flex col-md-12 align-items-center p-0">
            <div class="col-md-4 text-center">Enter Name</div>
            <div class="col-md-8 p-0">
              <input class="form-control p-1" id="EnterName" name="EnterName" type="text">
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button type="button" id="EnterDetailOfUser" class="btn btn-primary">Enter</button>
        </div>

      </div>
    </div>
  </div>

  <div class="row col-md-12 p-3 justify-content-center bg-light m-0">
    <div class="bg-white col-md-5">
      <ul style="list-style:none;max-height: 260px;" id="ulList" class="p-0 m-0 overflow-auto">
        <!-- <li class="d-flex justify-content-around"> <div class="p-0">Iteam:</div> <div class="p-0">AppleAppleApple,</div> <div class="p-0">Cost:</div> <div class="p-0">20</div></li> -->
      </ul>
    </div>
  </div>
  <!-- <button id="butt">hiii</button> -->
  <!-- </div> -->


  <script type="module">
    var name = 'khizar';
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.3/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCoPj0DvjAp8SWzSdhYwhWNb1GxieXQIZw",
      authDomain: "hessab-dfb99.firebaseapp.com",
      databaseURL: "https://hessab-dfb99-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "hessab-dfb99",
      storageBucket: "hessab-dfb99.appspot.com",
      messagingSenderId: "253864970407",
      appId: "1:253864970407:web:5df80f4b8212b331253382"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    import { getDatabase, ref, set, get, child, update, remove }
      from "https://www.gstatic.com/firebasejs/9.8.3/firebase-database.js"
    const database = getDatabase();
    const db = getDatabase();
    const dbRef = ref(getDatabase());
    // function writeUserData(userId, name, email, imageUrl) {
    // return set(ref(db, 'users/' + userId), {
    //   username: name,
    //   email: email,
    //   profile_picture: imageUrl
    // });
    // }
    // let c = writeUserData('123456', 'khizar', 'khizarsas', 'sdfcsdfsfws')
    // setTimeout((() => { console.log(c) }), 3000)
    function InsertUserEntry(saamaan,paisa) {
      set(ref(db, `${name}/` + Date().slice(4, -31).split(' ').join('')), {
        iteam: saamaan,
        price: paisa,
        date: Date().slice(0, 8)
      })
        .then(() => {
          console.log("Enter Record");
        })
        .catch((error) => { console.log(error) })
      console.log()
    }

    $(document).ready(function () {
      console.log('ready now')
      $('#entername').modal('show')

    });
    $('#EnterDetailOfUser').click(() => {
      name = $('#EnterName').val()
      get_data()
      $('#entername').modal('hide');
    })

    $('#EnterDetails').click(() => {
      console.log('kjsgdhvbfh', $('#SaamanName').val(), $('#Paisa').val())
      let tempContent = `<li class="d-flex justify-content-around"> <div class="p-0">Iteam:</div> <div class="p-0">${$('#SaamanName').val()},</div> <div class="p-0">Cost:</div> <div class="p-0">${$('#Paisa').val()}</div></li>`
      // `<li>${$('#SaamanName').val()},${$('#Paisa').val()}`;
      if ($('#SaamanName').val() == 'null' || $('#Paisa').val() == 0) {
        console.log('sahi se kar entry', name)
      } else {
        InsertUserEntry( $('#SaamanName').val(), $('#Paisa').val())
        document.getElementById('ulList').innerHTML += tempContent
        $('#myModal').modal('hide');
      }
    })
    // $('#butt').click(() => {
    //   get_data()
    //   // InsertUserEntry()
    // })
    function get_data() {
      let tempContent='';
      get(child(dbRef, `${name}`)).then((snapshot) => {
        if (snapshot.exists()) {
          let obj = snapshot.val()
          for(let k in obj)
				{
          tempContent += `<li class="d-flex justify-content-around"> <div class="p-0">Iteam:</div> <div class="p-0">${obj[k].iteam},</div> <div class="p-0">Cost:</div> <div class="p-0">${obj[k].price}</div></li>`
					console.log(obj[k])
				}
        document.getElementById('ulList').innerHTML += tempContent
        }
      })
    }
  </script>
</body>

</html>
